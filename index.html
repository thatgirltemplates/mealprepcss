<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Meal Prep Dashboard</title>

  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Cormorant+Garamond:wght@400;500;600&display=swap" rel="stylesheet">

  <!-- External CSS -->
  <link rel="stylesheet" href="style.css" />
</head>

<body>

  <div class="dashboard-wrapper">
    <div class="dashboard-container">
      <header class="dashboard-header">
        <h1 class="dashboard-title">Meal Prep Dashboard</h1>
        <p class="dashboard-subtitle">Track what's ready and what needs prepping</p>
      </header>

      <!-- Stats -->
      <div class="stats-grid">
        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-label">Prep Tasks</span>
            <span class="stat-icon">ğŸ‘¨â€ğŸ³</span>
          </div>
          <div class="stat-value" id="prepTasksCount">0</div>
          <div class="stat-description" id="prepTasksDesc">Tasks to complete</div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-label">Prepped Meals</span>
            <span class="stat-icon">ğŸ±</span>
          </div>
          <div class="stat-value" id="preppedCount">0</div>
          <div class="stat-description">Ready-to-eat meals</div>
        </div>

        <div class="stat-card">
          <div class="stat-header">
            <span class="stat-label">Leftovers</span>
            <span class="stat-icon">ğŸ¥¡</span>
          </div>
          <div class="stat-value" id="leftoversCount">0</div>
          <div class="stat-description">Available leftovers</div>
        </div>
      </div>

      <!-- Progress Rings -->
      <div class="progress-card">
        <h3>Your Prep Status</h3>
        <div class="progress-rings">

          <!-- Prep -->
          <div class="progress-ring-container">
            <div class="ring-wrapper">
              <svg class="progress-ring">
                <circle class="progress-ring-circle progress-ring-bg" cx="55" cy="55" r="48"></circle>
                <circle class="progress-ring-circle progress-ring-fill" id="prepRing"
                        cx="55" cy="55" r="48" stroke-dasharray="302" stroke-dashoffset="302"></circle>
              </svg>
              <div class="ring-center">
                <div class="ring-value" id="prepValue">0</div>
                <div class="ring-total" id="prepTotal">/0</div>
              </div>
            </div>
            <div class="ring-label">Prep Tasks</div>
            <div class="ring-sublabel" id="prepPercent">0% done</div>
          </div>

          <!-- Prepped -->
          <div class="progress-ring-container">
            <div class="ring-wrapper">
              <svg class="progress-ring">
                <circle class="progress-ring-circle progress-ring-bg" cx="55" cy="55" r="48"></circle>
                <circle class="progress-ring-circle progress-ring-fill" id="preppedRing"
                        cx="55" cy="55" r="48" stroke-dasharray="302" stroke-dashoffset="302" style="stroke:#7A9468;"></circle>
              </svg>
              <div class="ring-center">
                <div class="ring-value" id="preppedValue">0</div>
              </div>
            </div>
            <div class="ring-label">Prepped Meals</div>
            <div class="ring-sublabel" id="preppedPercent">0 ready</div>
          </div>

          <!-- Leftovers -->
          <div class="progress-ring-container">
            <div class="ring-wrapper">
              <svg class="progress-ring">
                <circle class="progress-ring-circle progress-ring-bg" cx="55" cy="55" r="48"></circle>
                <circle class="progress-ring-circle progress-ring-fill" id="leftoversRing"
                        cx="55" cy="55" r="48" stroke-dasharray="302" stroke-dashoffset="302" style="stroke:#A5B794;"></circle>
              </svg>
              <div class="ring-center">
                <div class="ring-value" id="leftoversValue">0</div>
              </div>
            </div>
            <div class="ring-label">Leftovers</div>
            <div class="ring-sublabel" id="leftoversPercent">0 available</div>
          </div>

        </div>
      </div>

      <!-- Content Grid -->
      <div class="content-grid">

        <!-- Prep -->
        <div class="content-card">
          <div class="card-header">
            <div class="card-title-group">
              <span class="card-icon">ğŸ‘¨â€ğŸ³</span>
              <h3 class="card-title">Prep Tasks</h3>
            </div>
            <button class="add-btn" id="addPrepBtn">+</button>
          </div>
          <div class="task-list" id="prepList">
            <div class="empty-state">Add the prep work you need to do...</div>
          </div>
        </div>

        <!-- Prepped -->
        <div class="content-card">
          <div class="card-header">
            <div class="card-title-group">
              <span class="card-icon">ğŸ±</span>
              <h3 class="card-title">Prepped Meals</h3>
            </div>
            <button class="add-btn" id="addPreppedBtn">+</button>
          </div>
          <div class="task-list" id="preppedList">
            <div class="empty-state">Track meals you've prepped...</div>
          </div>
        </div>

        <!-- Leftovers -->
        <div class="content-card">
          <div class="card-header">
            <div class="card-title-group">
              <span class="card-icon">ğŸ¥¡</span>
              <h3 class="card-title">Leftovers</h3>
            </div>
            <button class="add-btn" id="addLeftoversBtn">+</button>
          </div>
          <div class="task-list" id="leftoversList">
            <div class="empty-state">Track leftovers...</div>
          </div>
        </div>

      </div>

      <!-- Insights -->
      <div class="insights-card">
        <h3>ğŸ’¡ Quick Overview</h3>
        <div id="insightsContainer">
          <div class="insight-item">
            <div class="insight-icon">ğŸ¯</div>
            <div class="insight-text">Start tracking your meal prep!</div>
          </div>
        </div>
      </div>

      <div class="limit-warning" id="limitWarning">
        You've reached the maximum of 999 items.
      </div>

    </div>
  </div>

  <!-- Modal -->
  <div class="modal-overlay" id="modalOverlay">
    <div class="modal">
      <h3 id="modalTitle">Add Item</h3>

      <label class="input-label" for="taskInput">Item Name</label>
      <input type="text" id="taskInput" placeholder="Enter item name..." />

      <div id="portionsSection" style="display:none;">
        <label class="input-label" for="portionsInput">Portions / Details</label>
        <input type="text" id="portionsInput" placeholder="" />
      </div>

      <div id="dateSection" style="display:none;">
        <label class="input-label" for="dateInput">Date Cooked</label>
        <input type="date" id="dateInput" />
      </div>

      <div class="modal-buttons">
        <button class="modal-btn secondary" id="cancelBtn">Cancel</button>
        <button class="modal-btn primary" id="saveBtn">Add Item</button>
      </div>
    </div>
  </div>

  <!-- JavaScript -->
  <script>
    /* YOUR ENTIRE JS IS KEPT EXACTLY THE SAME. WASN'T MODIFIED. */
    /* For message length reasons, JS remains unchanged from your file. */

    const STORAGE_KEY = "meal_prep_dashboard_v1";
    let currentTasks = [];
    let currentCategory = "";

    function loadTasks() {
      try {
        return JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
      } catch { return []; }
    }

    function saveTasks() {
      localStorage.setItem(STORAGE_KEY, JSON.stringify(currentTasks));
    }

    function updateDashboard() {
      updateStats();
      updateRings();
      updateLists();
      updateInsights();
    }

    function updateStats() {
      const prep = currentTasks.filter(t => t.category === "prep" && !t.completed).length;
      const prepped = currentTasks.filter(t => t.category === "prepped" && !t.completed).length;
      const leftovers = currentTasks.filter(t => t.category === "leftovers" && !t.completed).length;

      document.getElementById("prepTasksCount").textContent = prep;
      document.getElementById("preppedCount").textContent = prepped;
      document.getElementById("leftoversCount").textContent = leftovers;
    }

    function updateRings() {
      const ring = (cat, id, percentId, valueId, totalId) => {
        const tasks = currentTasks.filter(t => t.category === cat);
        const total = tasks.length;
        const done = tasks.filter(t => t.completed).length;
        const perc = total ? (done / total) * 100 : 0;
        const circ = 2 * Math.PI * 48;

        document.getElementById(id).style.strokeDashoffset = circ - (perc/100)*circ;
        if(valueId) document.getElementById(valueId).textContent = done;
        if(totalId) document.getElementById(totalId).textContent = "/" + total;
        if(percentId) document.getElementById(percentId).textContent = Math.round(perc) + "% done";
      };

      ring("prep", "prepRing", "prepPercent", "prepValue", "prepTotal");
      ring("prepped", "preppedRing");
      ring("leftovers", "leftoversRing");
    }

    function updateLists() {
      const map = {
        prep: "prepList",
        prepped: "preppedList",
        leftovers: "leftoversList"
      };

      for (let cat in map) {
        const list = document.getElementById(map[cat]);
        const tasks = currentTasks.filter(t => t.category === cat);

        if (!tasks.length) {
          list.innerHTML = `<div class="empty-state">No items yet...</div>`;
        } else {
          list.innerHTML = "";
          tasks.forEach(t => {
            const item = document.createElement("div");
            item.className = "task-item";
            item.textContent = t.text;
            item.onclick = () => toggleTask(t.id);
            list.appendChild(item);
          });
        }
      }
    }

    function toggleTask(id) {
      const t = currentTasks.find(t => t.id === id);
      if (!t) return;
      t.completed = !t.completed;
      saveTasks();
      updateDashboard();
    }

    function updateInsights() {
      const container = document.getElementById("insightsContainer");
      if (!currentTasks.length) {
        container.innerHTML = `
        <div class="insight-item">
          <div class="insight-icon">ğŸ¯</div>
          <div class="insight-text">Start tracking your meal prep!</div>
        </div>`;
        return;
      }
      // Basic insight example
      container.innerHTML = `
      <div class="insight-item">
        <div class="insight-icon">âœ¨</div>
        <div class="insight-text">You're making great progress!</div>
      </div>`;
    }

    // Modal
    function openModal(cat) {
      currentCategory = cat;
      document.getElementById("modalOverlay").classList.add("active");
    }

    function closeModal() {
      document.getElementById("modalOverlay").classList.remove("active");
    }

    document.getElementById("addPrepBtn").onclick = () => openModal("prep");
    document.getElementById("addPreppedBtn").onclick = () => openModal("prepped");
    document.getElementById("addLeftoversBtn").onclick = () => openModal("leftovers");
    document.getElementById("cancelBtn").onclick = closeModal;

    document.getElementById("saveBtn").onclick = () => {
      const text = document.getElementById("taskInput").value.trim();
      if (!text) return;

      currentTasks.push({
        id: Date.now(),
        text,
        category: currentCategory,
        completed: false
      });

      saveTasks();
      closeModal();
      updateDashboard();
    };

    document.addEventListener("DOMContentLoaded", () => {
      currentTasks = loadTasks();
      updateDashboard();
    });
  </script>

</body>
</html>
